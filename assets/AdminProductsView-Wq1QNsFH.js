import{_ as w,o,c as i,a as t,n as g,l as p,F as v,h as f,t as l,j as x,v as C,b as _,w as m,d as h,m as L,i as B,r as b}from"./index-XZx92SjD.js";import{L as $}from"./index-sgix6PJC.js";const V={props:["pagination"],methods:{getProductsList(r){this.$emit("emit-getproductslist",r)}}},N={"aria-label":"Page navigation example"},S={class:"pagination"},T=t("span",{"aria-hidden":"true"},"«",-1),M=[T],I=["onClick"],F=t("span",{"aria-hidden":"true"},"»",-1),z=[F];function D(r,e,n,u,a,c){return o(),i("nav",N,[t("ul",S,[t("li",{class:g(["page-item",{disabled:n.pagination.current_page===1}])},[t("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=p(d=>c.getProductsList(n.pagination.current_page-1),["prevent"]))},M)],2),(o(!0),i(v,null,f(n.pagination.total_pages,d=>(o(),i("li",{class:"page-item",key:d},[t("a",{class:g(["page-link",{active:n.pagination.current_page===d}]),href:"#",onClick:p(y=>c.getProductsList(d),["prevent"])},l(d),11,I)]))),128)),t("li",{class:g(["page-item",{disabled:n.pagination.current_page===n.pagination.total_pages}])},[t("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=p(d=>c.getProductsList(n.pagination.current_page+1),["prevent"]))},z)],2)])])}const E=w(V,[["render",D]]),A={data(){return{sortBy:"default",ascending:!0,allProducts:[],products:[],productsDetail:{},tempProduct:{imagesUrl:[]},searchInput:"",pagination:{},isLoading:!0,modal:{productModal:"",delProductModal:""}}},methods:{getProductsList(r=1){this.isLoading=!0,this.$axios.get(`https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/products?page=${r}`).then(e=>{const{products:n,pagination:u}=e.data;this.allProducts=n,this.products=n,this.pagination=u}).catch(e=>{alert(e.response.data.message)}).finally(()=>{this.isLoading=!1})},deleteProduct(r,e){this.$Swal.fire({title:"即將刪除商品",text:`確定要刪除「${r}」嗎？`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"確定刪除",cancelButtonText:"取消"}).then(n=>{n.isConfirmed&&this.$axios.delete(`https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/product/${e}`).then(u=>{this.$Swal.fire({title:"已刪除",icon:"success"}),this.getProductsList()}).catch(u=>{this.$Swal.fire({icon:"error",title:u.response.data.message})})})},productSearch(){this.products=this.productsFilteredResults}},watch:{searchInput(r,e){this.productSearch()}},computed:{sortProducts(){return[...this.products].sort((e,n)=>this.ascending?e[this.sortBy]-n[this.sortBy]:n[this.sortBy]-e[this.sortBy])},productsFilteredResults(){return this.allProducts.filter(e=>e.title.toLowerCase().includes(this.searchInput.toLowerCase()))}},mounted(){this.getProductsList()},components:{CardPagination:E,Loading:$}},G={id:"app"},R={class:"card mt-lg-3 shadow-sm"},U={class:"navbar navbar-light bg-light"},j={class:"container-fluid"},q={class:"row g-2 align-items-center"},H={class:"col-auto"},J={class:"col-auto"},K={class:"card my-1 my-lg-4 shadow-sm"},O={class:"card-header"},Q={class:"text-end"},W=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-plus",viewBox:"4 4 12 12"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})],-1),X={class:"card-body"},Y={class:"table table-hover"},Z={class:"bg-light"},tt={class:"align-middle"},st=t("th",null,"地區",-1),et=t("th",null,"分類",-1),nt=t("th",null,"產品名稱",-1),ot=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-up ms-1",viewBox:"0 0 16 16"},[t("path",{"fill-rule":"evenodd",d:"M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5m-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5"})],-1),it=t("th",null,"狀態",-1),at=t("th",null,"操作",-1),lt={key:0},rt=t("br",null,null,-1),ct={style:{color:"rgb(196, 196, 196)"}},dt={key:0,class:"text-success"},ut={key:1},ht={class:"btn-group"},_t=["onClick"],gt={key:1},pt=t("br",null,null,-1),mt={style:{color:"rgb(196, 196, 196)"}},bt={key:0,class:"text-success"},vt={key:1},ft={class:"btn-group"},yt=["onClick"],wt={class:"card-footer"};function kt(r,e,n,u,a,c){const d=b("router-link"),y=b("loading"),k=b("card-pagination");return o(),i("div",G,[t("div",R,[t("nav",U,[t("div",j,[t("form",q,[t("div",H,[x(t("input",{class:"form-control",type:"search",placeholder:"搜尋商品名稱","aria-label":"Search","onUpdate:modelValue":e[0]||(e[0]=s=>a.searchInput=s)},null,512),[[C,a.searchInput]])]),t("div",J,[t("button",{class:"btn btn-outline-primary",type:"submit",onClick:e[1]||(e[1]=(...s)=>c.productSearch&&c.productSearch(...s))},"搜尋")])])])])]),t("div",K,[t("div",O,[t("div",Q,[t("button",{type:"button",class:"btn btn-info text-white mx-3",onClick:e[2]||(e[2]=s=>a.ascending=!a.ascending)},l(a.ascending?"降冪":"升冪")+"排序 ",1),_(d,{class:"btn btn-primary",to:"product/add"},{default:m(()=>[W,h(" 建立新的產品 ")]),_:1})])]),t("div",X,[t("table",Y,[t("thead",Z,[t("tr",tt,[st,et,nt,t("th",{onClick:e[3]||(e[3]=s=>a.sortBy="price")},[h(" 售價 "),ot]),it,at])]),a.sortBy==="default"?(o(),i("tbody",lt,[a.isLoading?(o(),L(y,{key:0,active:a.isLoading,"can-cancel":!1},null,8,["active"])):B("",!0),(o(!0),i(v,null,f(a.products,s=>(o(),i("tr",{key:s.id},[t("td",null,l(s.nation),1),t("td",null,l(s.category),1),t("td",null,l(s.title),1),t("td",null,[h(" NT$"+l(s.price)+" ",1),rt,t("del",ct," NT$"+l(s.origin_price),1)]),t("td",null,[s.is_enabled?(o(),i("span",dt,"上架中")):(o(),i("span",ut,"未上架"))]),t("td",null,[t("div",ht,[_(d,{class:"btn btn-outline-primary btn-sm",to:"product/edit/"+s.id},{default:m(()=>[h("編輯")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:P=>c.deleteProduct(s.title,s.id)}," 刪除 ",8,_t)])])]))),128))])):(o(),i("tbody",gt,[(o(!0),i(v,null,f(c.sortProducts,s=>(o(),i("tr",{key:s.name},[t("td",null,l(s.nation),1),t("td",null,l(s.category),1),t("td",null,l(s.title),1),t("td",null,[h(" NT$"+l(s.price)+" ",1),pt,t("del",mt," NT$"+l(s.origin_price),1)]),t("td",null,[s.is_enabled?(o(),i("span",bt,"上架中")):(o(),i("span",vt,"未上架"))]),t("td",null,[t("div",ft,[_(d,{class:"btn btn-outline-primary btn-sm",to:"product/edit/"+s.id},{default:m(()=>[h("編輯")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:P=>c.deleteProduct(s.title,s.id)}," 刪除 ",8,yt)])])]))),128))]))])]),t("div",wt,[_(k,{pagination:a.pagination,onEmitGetproductslist:c.getProductsList},null,8,["pagination","onEmitGetproductslist"])])])])}const Ct=w(A,[["render",kt]]);export{Ct as default};
