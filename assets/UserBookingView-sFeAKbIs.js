import{_ as L,m as c,a as T,r as m,o as r,c as _,g as S,w as p,h as F,b as e,F as V,i as I,t as n,d as l,n as h,k as E,v as U,f as b}from"./index-8ybFzMyS.js";import{c as d}from"./cartStore-2Xr1gVgk.js";import{L as A}from"./index-j5kmQL4p.js";import{_ as N}from"./loading-img2-JPOuMyya.js";const C="/vue-final/assets/step2-knG-x1_l.png";var O={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"ahmomoz",BASE_URL:"/vue-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:P,VITE_APIPATH:R}=O,j={data(){return{form:{user:{email:"",name:"",tel:"",address:"",date:""},message:""},createOrder:{}}},computed:{...c(d,["isLoading"]),...c(d,["cart"]),...c(d,["total"]),...c(d,["cartList"]),...c(d,["final_total"]),isFormIncomplete(){return!this.form.user.email||!this.form.user.name||!this.form.user.tel||!this.form.user.address}},methods:{...T(d,["getCartList"]),addOrder(){if(this.cartList.length>0){const s=new Date().toISOString();this.form.user.date=s;const x=this.form;this.isLoading=!0,this.$axios.post(`${P}/api/${R}/order`,{data:x}).then(g=>{this.$Swal.fire({title:"訂單送出成功",icon:"success"}),this.form={user:{email:"",name:"",tel:"",address:""},message:""},this.$router.push("/checkout-success")}).catch(g=>{this.$Swal.fire({icon:"error",title:g.response.data.message})}).finally(()=>{this.isLoading=!1})}else this.$Swal.fire({icon:"error",title:"購物車不得為空"})}},mounted(){this.getCartList()},components:{Loading:A}},B=e("img",{style:{width:"200px"},src:N,alt:"to-top-btn"},null,-1),D={class:"container-fluid cart-bg pt-lg-6 pb-5 py-xl-6 px-3 px-xl-10"},q=e("div",{class:"text-center mt-5"},[e("img",{class:"img-fluid",src:C,alt:"step-img"})],-1),$={key:0,class:"row flex-row-reverse justify-content-center pb-5","data-aos":"fade-up"},z={class:"col-md-4"},H={class:"border bg-white p-4 mb-4"},M=["src"],Q={class:"w-100"},G={class:"d-flex justify-content-between"},J={class:"mb-0 fw-bold"},K={class:"mb-0"},W={class:"mb-0 fw-bold"},X={class:"table mt-4 border-top border-bottom text-muted"},Y=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"小計",-1),Z={class:"text-end border-0 px-0 pt-4"},ee=e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"折扣金額",-1),se={class:"text-end border-0 px-0 pt-0 pb-4"},te={class:"d-flex justify-content-between mt-4"},oe=e("p",{class:"mb-0 h4 fw-bold"},"總計金額",-1),le={class:"mb-0 h4 fw-bold"},ae={class:"col-md-6"},ie=e("h2",{class:"mb-3"},"填寫訂購人資料",-1),re={class:"mb-3"},ne=e("label",{for:"email",class:"form-label"},"*Email",-1),de={class:"mb-3"},ce=e("label",{for:"name",class:"form-label"},"*收件人姓名",-1),me={class:"mb-3"},_e=e("label",{for:"tel",class:"form-label"},"*收件人電話",-1),ue={class:"mb-3"},fe=e("label",{for:"address",class:"form-label"},"*收件人地址",-1),pe={class:"mb-3"},he=e("label",{for:"message",class:"form-label"},"留言",-1),be={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end w-100"},ge=e("i",{class:"bi bi-chevron-left"},null,-1),ve=["disabled"],xe={key:1,class:"py-5"},we=e("h2",{class:"text-center"},[b("目前購物車無任何商品Q_Q"),e("br"),b("趕快來去選購吧")],-1),Ve=[we],ye={class:"d-flex justify-content-end my-4"},ke=e("i",{class:"bi bi-chevron-double-right"},null,-1);function Le(i,s,x,g,a,v){const y=m("loading"),u=m("VeeField"),f=m("error-message"),w=m("RouterLink"),k=m("VeeForm");return r(),_(V,null,[i.isLoading?(r(),S(y,{key:0,active:i.isLoading,"can-cancel":!1},{default:p(()=>[B]),_:1},8,["active"])):F("",!0),e("main",D,[q,i.cartList.length>0?(r(),_("div",$,[e("div",z,[e("div",H,[(r(!0),_(V,null,I(i.cartList,t=>(r(),_("div",{class:"d-flex mt-2",key:t.id},[e("img",{src:t.product.imagesUrl[0],alt:"product-img",class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,M),e("div",Q,[e("div",G,[e("p",J,n(t.product.title),1),e("p",K,"NT$"+n(t.product.price),1)]),e("p",W,"x"+n(t.qty),1)])]))),128)),e("table",X,[e("tbody",null,[e("tr",null,[Y,e("td",Z,"NT$"+n(i.total.toFixed(0)),1)]),e("tr",null,[ee,e("td",se," -NT$"+n((i.final_total-i.total).toFixed(0)),1)])])]),e("div",te,[oe,e("p",le,"NT$"+n(i.final_total.toFixed(0)),1)])])]),e("div",ae,[ie,l(k,{ref:"form",onSubmit:t=>""},{default:p(({errors:t})=>[e("div",re,[ne,l(u,{id:"email",name:"email",type:"email",class:h(["form-control",{"is-invalid":t.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:a.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=o=>a.form.user.email=o)},null,8,["class","modelValue"]),l(f,{name:"email",class:"invalid-feedback"})]),e("div",de,[ce,l(u,{id:"name",name:"姓名",type:"text",class:h(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:a.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=o=>a.form.user.name=o)},null,8,["class","modelValue"]),l(f,{name:"姓名",class:"invalid-feedback"})]),e("div",me,[_e,l(u,{id:"tel",name:"電話",type:"text",class:h(["form-control",{"is-invalid":t.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:a.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=o=>a.form.user.tel=o)},null,8,["class","modelValue"]),l(f,{name:"電話",class:"invalid-feedback"})]),e("div",ue,[fe,l(u,{id:"address",name:"地址",type:"text",class:h(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:a.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=o=>a.form.user.address=o)},null,8,["class","modelValue"]),l(f,{name:"地址",class:"invalid-feedback"})]),e("div",pe,[he,E(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=o=>a.form.message=o)},`\r
            `,512),[[U,a.form.message]])]),e("div",be,[l(w,{to:"/cart",class:"text-dark mt-md-0 mt-3"},{default:p(()=>[ge,b(" 返回上一步 ")]),_:1}),e("button",{type:"submit",class:"btn btn-primary py-3 px-5 rounded-0",onClick:s[5]||(s[5]=(...o)=>v.addOrder&&v.addOrder(...o)),disabled:v.isFormIncomplete}," 送出訂單 ",8,ve)])]),_:1},512)])])):(r(),_("div",xe,Ve)),e("div",ye,[l(w,{to:"/products",class:"fs-5 text-decoration-none link-hover"},{default:p(()=>[b(" 繼續購物 "),ke]),_:1})])])],64)}const Ee=L(j,[["render",Le]]);export{Ee as default};
