import{L as h}from"./index-RIvZXr4n.js";import{h as _}from"./moment-WSJ9un1t.js";import{_ as u,c as d,a as s,t as r,m as f,i as p,F as g,h as b,r as y,o as i}from"./index-CEKiAcMy.js";const x={props:["id"],data(){return{order:{},isLoading:!0,currentPage:""}},methods:{getOrderList(c){this.isLoading=!0;const{id:e}=this.$route.params;this.$axios.get(`https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/orders?page=${c}`).then(l=>{const n=l.data.orders;this.order=n.find(t=>t.id.toLowerCase().includes(e.toLowerCase()))}).catch(l=>{this.$Swal.fire({icon:"error",title:l.response.data.message})}).finally(()=>{this.isLoading=!1})},goBack(){this.$router.push("/admin/orders")},togglePaymentStatus(){this.isLoading=!0,this.order.is_paid=!this.order.is_paid;const{id:c}=this.$route.params;this.$axios.put(`https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/order/${c}`,{data:this.order}).then(e=>{this.$Swal.fire({icon:"success",title:"更新成功"}),this.getOrderList(this.currentPage)}).catch(e=>{this.$Swal.fire({icon:"error",title:e.response.data.message})}).finally(()=>{this.isLoading=!1})},deleteOrder(){this.$Swal.fire({title:"即將刪除商品",text:`確定要刪除「${this.order.create_at}」嗎？`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#eb5a68",cancelButtonColor:"#8bafd7",confirmButtonText:"確定刪除",cancelButtonText:"取消"}).then(c=>{c.isConfirmed&&this.$axios.delete(`https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/order/${this.order.id}`).then(e=>{this.$Swal.fire({title:"已刪除",icon:"success"}),this.$router.push("/admin/orders")}).catch(e=>{this.$Swal.fire({icon:"error",title:e.response.data.message})})})},formatDateString(c){return _(c).format("YYYY-MM-DD HH:mm:ss")}},created(){this.isLoading=!1,this.currentPage=this.$route.query.currentPage,this.getOrderList(this.currentPage)},components:{Loading:h}},v={class:"container"},w={class:"d-flex justify-content-between my-3"},k=s("h1",{class:"fs-3"},"訂單詳情",-1),L={class:"row rounded border-2 border-dashed-blue p-2"},S=s("dt",{class:"col-sm-3 text-truncate text-primary"},"訂單編號",-1),B={class:"col-sm-9 text-primary"},C=s("dt",{class:"col-sm-3 text-truncate text-primary"},"訂單金額",-1),P={class:"col-sm-9 text-primary"},O=s("dt",{class:"col-sm-3 text-truncate text-primary"},"訂單狀態",-1),$={key:0,class:"col-sm-9 text-primary"},D={key:1,class:"col-sm-9 text-primary"},N=s("dt",{class:"col-sm-3 text-truncate text-primary"},"發票狀態",-1),T=s("dd",{class:"col-sm-9 text-primary"},"未開立",-1),Y={class:"row card mt-4 shadow-sm"},z=s("div",{class:"card-header"},[s("h5",{class:"my-1"},"購買商品")],-1),V={class:"card-body"},q=["src"],E={class:"mx-2 my-auto"},F={class:"text-end mx-2 my-auto"},H={class:"card-footer"},M={class:"text-end fs-5 m-0"},j={class:"row card mt-4 shadow-sm"},A=s("div",{class:"card-header"},[s("h5",{class:"my-1"},"收件人資訊")],-1),U={class:"card-body"},G={class:"mb-3"},I=s("label",{for:"name",class:"form-label fw-bold"},"姓名",-1),J={class:"fs-5"},K={class:"mb-3"},Q=s("label",{for:"tel",class:"form-label fw-bold"},"電話",-1),R={class:"fs-5"},W={class:"mb-3"},X=s("label",{for:"address",class:"form-label fw-bold"},"地址",-1),Z={class:"fs-5"},ss={class:"mb-3"},ts=s("label",{for:"email",class:"form-label fw-bold"},"E-mail",-1),es={class:"fs-5"},os={class:"mb-3"},rs=s("label",{for:"message",class:"form-label fw-bold"},"備註",-1),is={key:0,class:"fs-5"},as={key:1,class:"fs-5"},ds={class:"mb-3"},cs=s("label",{for:"message",class:"form-label fw-bold"},"訂單成立時間",-1),ls={class:"fs-5"},ns={class:"text-end mt-3 mb-5"};function ms(c,e,l,n,t,a){const m=y("loading");return i(),d("div",v,[s("div",w,[k,t.order.is_paid?(i(),d("button",{key:0,type:"button",class:"btn btn-primary text-light",onClick:e[0]||(e[0]=(...o)=>a.togglePaymentStatus&&a.togglePaymentStatus(...o))},"切換成未付款")):(i(),d("button",{key:1,type:"button",class:"btn btn-primary text-light",onClick:e[1]||(e[1]=(...o)=>a.togglePaymentStatus&&a.togglePaymentStatus(...o))},"切換成已付款"))]),s("dl",L,[S,s("dd",B,r(t.order.create_at),1),C,s("dd",P,"NT $"+r(t.order.total),1),O,t.order.is_paid?(i(),d("dd",$,"訂單已付款完成")):(i(),d("dd",D,"訂單尚未付款")),N,T]),s("div",Y,[z,s("div",V,[t.isLoading?(i(),f(m,{key:0,active:t.isLoading,"can-cancel":!1},null,8,["active"])):p("",!0),(i(!0),d(g,null,b(t.order.products,o=>(i(),d("div",{key:o.product.id,class:"d-flex align-items-center m-2"},[s("img",{src:o.product.imagesUrl[0],alt:"商品圖片",style:{width:"100px"}},null,8,q),s("p",E,r(o.product.title)+" x "+r(o.qty),1),s("p",F,"NT$ "+r(o.product.price),1)]))),128))]),s("div",H,[s("p",M,"總金額 NT$ "+r(t.order.total),1)])]),s("div",j,[A,s("div",U,[s("div",G,[I,s("p",J,r(t.order.user.name),1)]),s("div",K,[Q,s("p",R,r(t.order.user.tel),1)]),s("div",W,[X,s("p",Z,r(t.order.user.address),1)]),s("div",ss,[ts,s("p",es,r(t.order.user.email),1)]),s("div",os,[rs,t.order.user.message?(i(),d("p",is,r(t.order.user.message),1)):(i(),d("p",as,"無填寫備註"))]),s("div",ds,[cs,s("p",ls,r(a.formatDateString(t.order.user.date)),1)])])]),s("div",ns,[s("button",{type:"button",class:"btn btn-outline-secondary mx-2",onClick:e[2]||(e[2]=(...o)=>a.goBack&&a.goBack(...o))}," 返回前頁 "),s("button",{type:"button",class:"btn btn-danger text-light",onClick:e[3]||(e[3]=(...o)=>a.deleteOrder&&a.deleteOrder(...o))}," 刪除訂單 ")])])}const fs=u(x,[["render",ms]]);export{fs as default};
