import{C as P}from"./CardPagination-JCfJ-hix.js";import{L as k}from"./index-vf2sePQf.js";import{_ as w,r as m,o as n,c as i,b as t,k as C,v as x,t as l,d as _,w as p,f as d,g as B,h as L,F as g,i as b}from"./index-NTjvrLLD.js";var T={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"ahmomoz",BASE_URL:"/vue-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:I,VITE_APIPATH:S}=T,V={data(){return{sortBy:"default",ascending:!0,allProducts:[],products:[],searchInput:"",pagination:{},isLoading:!0}},methods:{getProductsList(a=1){this.isLoading=!0,this.$axios.get(`${I}/api/${S}/admin/products?page=${a}`).then(e=>{const{products:c,pagination:u}=e.data;this.allProducts=c,this.products=c,this.pagination=u}).catch(e=>{alert(e.response.data.message)}).finally(()=>{this.isLoading=!1})},deleteProduct(a,e){this.$Swal.fire({title:"即將刪除商品",text:`確定要刪除「${a}」嗎？`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#eb5a68",cancelButtonColor:"#8bafd7",confirmButtonText:"確定刪除",cancelButtonText:"取消"}).then(c=>{c.isConfirmed&&this.$axios.delete(`https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/product/${e}`).then(u=>{this.$Swal.fire({position:"top-end",title:"已刪除",icon:"success",showConfirmButton:!1,timer:700}),this.getProductsList()}).catch(u=>{this.$Swal.fire({icon:"error",title:u.response.data.message})})})},productSearch(){this.products=this.productsFilteredResults},formatPrice(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},computed:{sortProducts(){return[...this.products].sort((e,c)=>this.ascending?e[this.sortBy]-c[this.sortBy]:c[this.sortBy]-e[this.sortBy])},productsFilteredResults(){return this.allProducts.filter(e=>e.title.toLowerCase().includes(this.searchInput.toLowerCase()))}},mounted(){this.getProductsList()},components:{CardPagination:P,Loading:k}},E={class:"card mt-lg-3 shadow-sm"},A={class:"navbar navbar-light bg-light"},N={class:"container-fluid"},R={class:"row g-2 align-items-center"},D={class:"col-auto"},F={class:"col-auto"},U={class:"card my-1 my-lg-4 shadow-sm"},$={class:"card-header"},z={class:"text-end py-2"},G=t("span",{class:"bi bi-plus"},null,-1),H={class:"card-body"},M={class:"table table-hover"},O={class:"bg-light"},j={class:"align-middle"},q=t("th",null,"分類",-1),J=t("th",null,"地區",-1),K=t("th",null,"產品名稱",-1),Q=t("span",{class:"bi bi-arrow-down-up ms-1"},null,-1),W=t("th",null,"狀態",-1),X=t("th",null,"操作",-1),Y={key:0},Z=t("br",null,null,-1),tt={style:{color:"rgb(196, 196, 196)"}},st={key:0,class:"text-primary"},et={key:1},nt={class:"btn-group"},ot=["onClick"],it={key:1},lt=t("br",null,null,-1),rt={style:{color:"rgb(196, 196, 196)"}},at={key:0,class:"text-success"},ct={key:1},dt={class:"btn-group"},ut=["onClick"],_t={class:"card-footer d-flex justify-content-center"};function ht(a,e,c,u,o,r){const h=m("router-link"),f=m("loading"),y=m("CardPagination");return n(),i(g,null,[t("div",E,[t("nav",A,[t("div",N,[t("form",R,[t("div",D,[C(t("input",{class:"form-control",type:"search",placeholder:"搜尋商品名稱","aria-label":"Search","onUpdate:modelValue":e[0]||(e[0]=s=>o.searchInput=s)},null,512),[[x,o.searchInput]])]),t("div",F,[t("button",{class:"btn btn-outline-primary",type:"submit",onClick:e[1]||(e[1]=(...s)=>r.productSearch&&r.productSearch(...s))},"搜尋 ")])])])])]),t("div",U,[t("div",$,[t("div",z,[t("button",{type:"button",class:"btn btn-primary text-white mx-3",onClick:e[2]||(e[2]=s=>o.ascending=!o.ascending)},l(o.ascending?"降冪":"升冪")+"排序 ",1),_(h,{class:"btn btn-primary text-light",to:"product/add"},{default:p(()=>[G,d(" 建立新的產品 ")]),_:1})])]),t("div",H,[t("table",M,[t("thead",O,[t("tr",j,[q,J,K,t("th",{onClick:e[3]||(e[3]=s=>o.sortBy="price")},[d(" 售價 "),Q]),W,X])]),o.sortBy==="default"?(n(),i("tbody",Y,[o.isLoading?(n(),B(f,{key:0,active:o.isLoading,"can-cancel":!1},null,8,["active"])):L("",!0),(n(!0),i(g,null,b(o.products,s=>(n(),i("tr",{key:s.id},[t("td",null,l(s.category),1),t("td",null,l(s.nation),1),t("td",null,l(s.title),1),t("td",null,[d(" NT$"+l(r.formatPrice(s.price))+" ",1),Z,t("del",tt," NT$"+l(r.formatPrice(s.origin_price)),1)]),t("td",null,[s.is_enabled?(n(),i("span",st,"上架中")):(n(),i("span",et,"未上架"))]),t("td",null,[t("div",nt,[_(h,{class:"btn btn-outline-primary btn-sm",to:"product/edit/"+s.id},{default:p(()=>[d(" 編輯 ")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:v=>r.deleteProduct(s.title,s.id)}," 刪除 ",8,ot)])])]))),128))])):(n(),i("tbody",it,[(n(!0),i(g,null,b(r.sortProducts,s=>(n(),i("tr",{key:s.name},[t("td",null,l(s.category),1),t("td",null,l(s.nation),1),t("td",null,l(s.title),1),t("td",null,[d(" NT$"+l(r.formatPrice(s.price))+" ",1),lt,t("del",rt," NT$"+l(r.formatPrice(s.origin_price)),1)]),t("td",null,[s.is_enabled?(n(),i("span",at,"上架中")):(n(),i("span",ct,"未上架"))]),t("td",null,[t("div",dt,[_(h,{class:"btn btn-outline-primary btn-sm",to:"product/edit/"+s.id},{default:p(()=>[d(" 編輯 ")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:v=>r.deleteProduct(s.title,s.id)}," 刪除 ",8,ut)])])]))),128))]))])]),t("div",_t,[_(y,{pagination:o.pagination,onEmitGetlist:r.getProductsList},null,8,["pagination","onEmitGetlist"])])])],64)}const bt=w(V,[["render",ht]]);export{bt as default};
