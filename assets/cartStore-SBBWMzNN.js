import{u as d,x as s,S as i}from"./index-erzOO78X.js";import{L as l}from"./index-LMUAtbb4.js";var h={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"ahmomoz",BASE_URL:"/vue-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:o,VITE_APIPATH:r}=h,p=d("cartStore",{state:()=>({cart:[],final_total:0,total:0,cartList:{},cartListTotalQty:"",isLoading:!0}),actions:{getCartList(){this.isLoading=!0,s.get(`${o}/api/${r}/cart`).then(t=>{this.cart=t.data.data.cart,this.final_total=t.data.data.final_total,this.total=t.data.data.total,this.cartList=t.data.data.carts,this.cartListTotalQty=t.data.data.carts.reduce((a,e)=>a+e.qty,0)}).catch(t=>{i.fire({icon:"error",title:t})}).finally(()=>{this.isLoading=!1})},addToCart(t,a){this.isLoading=!0;const e={data:{product_id:t.id,qty:a}};s.post(`${o}/api/${r}/cart`,e).then(n=>{i.fire({position:"top-end",icon:"success",title:"成功加入購物車",showConfirmButton:!1,timer:700}),this.getCartList()}).catch(n=>{i.fire({icon:"error",title:n.response})}).finally(()=>{this.isLoading=!1})},useCoupon(t){this.isLoading=!0;const a={data:{code:t}};s.post(`${o}/api/${r}/coupon`,a).then(e=>{this.getCartList()}).catch(e=>{i.fire({icon:"error",title:e.response.data.message})}).finally(()=>{this.isLoading=!1})},updateQty(t,a){this.isLoading=!0;const e=parseInt(a.target.value,10),n={data:{product_id:t.id,qty:e}};s.put(`${o}/api/${r}/cart/${t.id}`,n).then(c=>{this.getCartList()}).catch(c=>{i.fire({icon:"error",title:c.response.data.message})}).finally(()=>{this.isLoading=!1})},deleteProduct(t){this.isLoading=!0,s.delete(`${o}/api/${r}/cart/${t.id}`).then(a=>{i.fire({position:"top-end",icon:"success",title:"已刪除",showConfirmButton:!1,timer:700}),this.getCartList()}).catch(a=>{i.fire({icon:"error",title:a.response.data.message})}).finally(()=>{this.isLoading=!1})},deleteCart(){i.fire({title:"確定要清空購物車嗎？",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then(t=>{t.isConfirmed&&(this.isLoading=!0,s.delete(`${o}/api/${r}/carts`).then(a=>{i.fire({title:"已清空購物車",icon:"success"}),this.getCartList()}).catch(a=>{i.fire({icon:"error",title:a.response.data.message})}).finally(()=>{this.isLoading=!1}))})}},components:{Loading:l}});export{p as c};
