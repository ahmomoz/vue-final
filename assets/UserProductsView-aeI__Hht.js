import{C as q}from"./CardPagination-ZXptYOdk.js";import{L as I}from"./index-T4iu_HKs.js";import{_ as R,r as w,o as l,c as n,s as C,t as P,a as t,b as h,w as p,u as i,e as d,v as x,x as S,y as T,F as f,q as g,z as m,A as L,B as V}from"./index-AmqyvTUw.js";import{_ as E}from"./leaf-primary-geahJmbm.js";var j={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"ahmomoz",BASE_URL:"/vue-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:b,VITE_APIPATH:k}=j,O={data(){return{products:[],allProducts:[],nations:[],taiwanAreas:[],japanAreas:[],selectedOption:"最新上架",options:["最新上架","價格 (從低到高)","價格 (從高到低)"],sortBy:"default",ascending:!0,searchInput:"",filterArea:[],category:"",pagination:{},isLoading:!0}},methods:{getProductsList(o=1){this.isLoading=!0,this.$axios.get(`${b}/api/${k}/products?page=${o}`).then(e=>{const{products:c,pagination:A}=e.data;this.products=c,this.pagination=A,this.sortBy="default",this.selectedOption="最新上架",this.searchInput="",this.$route.query.category&&(this.category=this.$route.query.category,this.productCategoryFilter(this.category))}).catch(e=>{this.$Swal.fire({icon:"error",title:e.response.data.message})}).finally(()=>{this.isLoading=!1})},getAllProductsList(){this.isLoading=!0,this.$axios.get(`${b}/api/${k}/products/all`).then(o=>{this.allProducts=o.data.products,this.getAreas(),this.getProductsList()}).catch(o=>{this.$Swal.fire({icon:"error",title:o.response.data.message})}).finally(()=>{this.isLoading=!1})},getRouterCategory(){this.category=this.$route.query.category,this.productCategoryFilter(this.category)},getAreas(){this.allProducts.forEach(o=>{o.nation==="台灣"&&!this.taiwanAreas.includes(o.area)?this.taiwanAreas.push(o.area):o.nation==="日本"&&!this.japanAreas.includes(o.area)&&this.japanAreas.push(o.area)}),this.taiwanAreas=Array.from(this.taiwanAreas).sort(),this.japanAreas=Array.from(this.japanAreas).sort()},selectOption(o){this.selectedOption=o,this.selectedOption==="價格 (從低到高)"?(this.sortBy="price",this.ascending=!0):this.selectedOption==="價格 (從高到低)"?(this.sortBy="price",this.ascending=!1):this.sortBy="default"},addToCart(o){const e={data:{product_id:o.id,qty:1}};this.isLoading=!0,this.$axios.post(`${b}/api/${k}/cart`,e).then(c=>{this.$Swal.fire({position:"top-end",icon:"success",title:"成功加入購物車",showConfirmButton:!1,timer:700})}).catch(c=>{this.$Swal.fire({icon:"error",title:c.response})}).finally(()=>{this.isLoading=!1})},productSearch(){this.searchInput!==""?this.products=this.productsSearchResults:this.getProductsList()},productAreaFilter(){this.filterArea.length!==0?this.products=this.productsAreaFilterResults:this.getProductsList()},productCategoryFilter(o){this.filterArea=[],this.category=o,this.category?this.products=this.productsCategoryFilterResults:this.getProductsList()}},computed:{sortProducts(){return[...this.products].sort((e,c)=>this.ascending?e[this.sortBy]-c[this.sortBy]:c[this.sortBy]-e[this.sortBy])},productsSearchResults(){return this.allProducts.filter(e=>e.title.toLowerCase().includes(this.searchInput.toLowerCase()))},productsAreaFilterResults(){return this.sortBy!=="default"||this.searchInput!==""||this.category!==""?this.products.filter(e=>this.filterArea.some(c=>e.area.toLowerCase().includes(c.toLowerCase()))):this.allProducts.filter(e=>this.filterArea.some(c=>e.area.toLowerCase().includes(c.toLowerCase())))},productsCategoryFilterResults(){return this.allProducts.filter(e=>e.category.toLowerCase().includes(this.category.toLowerCase()))}},mounted(){this.getAllProductsList()},components:{CardPagination:q,Loading:I}},U={class:"container-fluid bg-light py-8 px-5 px-xl-10"},N={class:"mb-5","aria-label":"breadcrumb"},z={class:"breadcrumb"},M={class:"breadcrumb-item"},D={class:"breadcrumb-item active","aria-current":"page"},$=t("p",{class:"fs-3 text-gray my-0 ms-5"},"Products",-1),G={class:"lh-base fs-1 text-gray"},H=t("img",{src:E,alt:"logo",class:"img-fluid"},null,-1),K={class:"w-50 d-flex justify-content-between bg-white shadow-sm rounded-pill mt-4 px-lg-4 py-lg-3"},J=t("i",{class:"bi bi-search my-auto"},null,-1),Q={class:"container-fluid px-xl-10 mt-5 mt-xl-5"},W={class:"d-flex flex-wrap justify-content-center"},X=t("br",null,null,-1),Y={class:"row my-4 my-xl-5"},Z={class:"col-3 card d-none d-xl-block"},tt={class:"position-sticky card-body",style:{top:"5rem"}},st={class:"p-4"},et=t("h3",{class:"fw-500"},"依地區篩選",-1),ot=t("h4",{class:"fw-500 mt-xl-4"},"台灣",-1),rt=["value","id"],it=["for"],at={class:"p-4"},lt=t("h4",{class:"fw-500 mt-xl-4"},"日本",-1),nt=["value","id"],ct=["for"],dt={class:"col-xl-9"},ut={class:"container-fluid"},ht={class:"dropdown d-flex justify-content-end"},pt=t("p",{class:"fs-5 my-auto me-3"},"排序方式",-1),yt={class:"btn btn-outline-primary fs-5 py-2 px-4 dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false",style:{width:"200px"}},_t={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},ft=["onClick"],mt={key:0,class:"row row-cols-1 row-cols-md-2 row-cols-lg-3"},gt={class:"card h-100 mb-4 border-0 shadow-sm product-card-hover"},wt={style:{position:"relative"}},vt={class:"fs-5 text-dark bg-white ps-2 opacity-75",style:{position:"absolute",top:"15px","z-index":"2"}},xt=t("i",{class:"bi bi-geo-alt-fill"},null,-1),bt=["src"],kt={class:"card-body"},At={class:"fs-5 text-primary"},Ct=t("i",{class:"bi bi-play-fill"},null,-1),Pt={class:"card-text text-dark my-2 link-hover"},Lt={class:"fs-5 text-primary fw-bolder"},Bt={style:{color:"rgb(196, 196, 196)"}},Ft=t("br",null,null,-1),qt={key:1,class:"row row-cols-1 row-cols-md-2 row-cols-lg-3"},It={class:"card h-100 mb-4 border-0 shadow-sm product-card-hover"},Rt={style:{position:"relative"}},St={class:"fs-5 text-dark bg-white ps-2 opacity-75",style:{position:"absolute",top:"15px","z-index":"2"}},Tt=t("i",{class:"bi bi-geo-alt-fill"},null,-1),Vt=["src"],Et={class:"card-body"},jt={class:"fs-5 text-primary"},Ot=t("i",{class:"bi bi-play-fill"},null,-1),Ut={class:"card-text text-dark my-2 link-hover"},Nt={class:"fs-5 text-primary fw-bolder"},zt={style:{color:"rgb(196, 196, 196)"}},Mt=t("br",null,null,-1),Dt={class:"d-flex justify-content-center mt-4 mt-xl-6"};function $t(o,e,c,A,r,a){const B=w("loading"),v=w("RouterLink"),_=w("router-link"),F=w("card-pagination");return l(),n(f,null,[r.isLoading?(l(),C(B,{key:0,active:r.isLoading,"can-cancel":!1},null,8,["active"])):P("",!0),t("div",U,[t("nav",N,[t("ol",z,[t("li",M,[h(v,{class:"text-decoration-none",to:"/home",exact:""},{default:p(()=>[d("首頁")]),_:1})]),t("li",D,i(r.category===""||r.category===void 0?"所有商品":r.category),1)])]),$,t("h2",G,[H,d(" "+i(r.category===""||r.category===void 0?"所有商品":`${r.category} 所有商品`),1)]),t("div",K,[J,x(t("input",{class:"fs-5 form-control border-0",type:"search",placeholder:"想找些什麼呢？","onUpdate:modelValue":e[0]||(e[0]=s=>r.searchInput=s),onKeyup:e[1]||(e[1]=T((...s)=>a.productSearch&&a.productSearch(...s),["enter"]))},null,544),[[S,r.searchInput]])])]),t("div",Q,[t("div",W,[h(_,{to:"/products",class:"w-100 card nav-link link-hover p-xl-2 shadow-sm me-xl-3",onClick:e[2]||(e[2]=s=>a.productCategoryFilter(""))},{default:p(()=>[t("p",{class:m(["fs-3 m-auto",{"text-primary":!o.$route.query.category}])},"所有商品",2)]),_:1}),h(_,{to:{name:"產品列表",query:{category:"動物園"}},class:"w-100 card nav-link link-hover p-xl-2 shadow-sm me-xl-3",onClick:e[3]||(e[3]=s=>a.productCategoryFilter("動物園"))},{default:p(()=>[t("p",{class:m(["fs-3 m-auto",{"text-primary":o.$route.query.category==="動物園"}])},"動物園",2)]),_:1}),h(_,{to:{name:"產品列表",query:{category:"動物聚落"}},class:"w-100 card nav-link link-hover p-xl-2 shadow-sm me-xl-3",onClick:e[4]||(e[4]=s=>a.productCategoryFilter("動物聚落"))},{default:p(()=>[t("p",{class:m(["fs-3 m-auto",{"text-primary":o.$route.query.category==="動物聚落"}])},[d("動物村/"),X,d("動物聚落")],2)]),_:1}),h(_,{to:{name:"產品列表",query:{category:"農場"}},class:"w-100 card nav-link link-hover p-xl-2 shadow-sm me-xl-3",onClick:e[5]||(e[5]=s=>a.productCategoryFilter("農場"))},{default:p(()=>[t("p",{class:m(["fs-3 m-auto",{"text-primary":o.$route.query.category==="農場"}])},"動物農場",2)]),_:1}),h(_,{to:{name:"產品列表",query:{category:"水族館"}},class:"w-100 card nav-link link-hover p-xl-2 shadow-sm me-xl-3",onClick:e[6]||(e[6]=s=>a.productCategoryFilter("水族館"))},{default:p(()=>[t("p",{class:m(["fs-3 m-auto",{"text-primary":o.$route.query.category==="水族館"}])},"水族館",2)]),_:1}),h(_,{to:{name:"產品列表",query:{category:"鳥園"}},class:"w-100 card nav-link link-hover p-xl-2 shadow-sm me-xl-3",onClick:e[7]||(e[7]=s=>a.productCategoryFilter("鳥園"))},{default:p(()=>[t("p",{class:m(["fs-3 m-auto",{"text-primary":o.$route.query.category==="鳥園"}])},"鳥園",2)]),_:1})]),t("div",Y,[t("div",Z,[t("div",tt,[t("div",st,[et,ot,(l(!0),n(f,null,g(r.taiwanAreas,(s,u)=>(l(),n("div",{class:"form-check",key:"taiwanArea"+u},[x(t("input",{class:"form-check-input fs-5 mt-xl-3",type:"checkbox",value:s,id:s+u,"onUpdate:modelValue":e[8]||(e[8]=y=>r.filterArea=y),onChange:e[9]||(e[9]=(...y)=>a.productAreaFilter&&a.productAreaFilter(...y))},null,40,rt),[[L,r.filterArea]]),t("label",{class:"form-check-label fs-5 mt-xl-2",for:s+u},i(s),9,it)]))),128))]),t("div",at,[lt,(l(!0),n(f,null,g(r.japanAreas,(s,u)=>(l(),n("div",{class:"form-check",key:"japanArea"+u},[x(t("input",{class:"form-check-input fs-5 mt-xl-3",type:"checkbox",value:s,id:s+u,"onUpdate:modelValue":e[10]||(e[10]=y=>r.filterArea=y),onChange:e[11]||(e[11]=(...y)=>a.productAreaFilter&&a.productAreaFilter(...y))},null,40,nt),[[L,r.filterArea]]),t("label",{class:"form-check-label fs-5 mt-xl-2",for:s+u},i(s),9,ct)]))),128))])])]),t("div",dt,[t("div",ut,[t("div",ht,[pt,t("button",yt,i(r.selectedOption),1),t("ul",_t,[(l(!0),n(f,null,g(r.options,(s,u)=>(l(),n("li",{key:u},[t("a",{class:"dropdown-item fs-5",href:"#",onClick:V(y=>a.selectOption(s),["prevent"])},i(s),9,ft)]))),128))])]),r.sortBy==="default"?(l(),n("div",mt,[(l(!0),n(f,null,g(r.products,s=>(l(),n("div",{class:"col mt-4",key:s.id},[h(v,{class:"text-decoration-none",to:`/product/${s.id}`},{default:p(()=>[t("div",gt,[t("div",wt,[t("div",null,[t("span",vt,[xt,d(" "+i(s.nation)+i(s.area),1)]),t("img",{src:s.imagesUrl[0],style:{height:"240px","z-index":"1"},class:"card-img-top object-fit-cover",alt:"product-img"},null,8,bt)])]),t("div",kt,[t("span",At,[Ct,d(" "+i(s.category),1)]),t("h4",Pt,i(s.title),1),t("p",null,i(s.feature),1),t("p",Lt,[t("del",Bt," NT$"+i(s.origin_price),1),Ft,d(" NT$"+i(s.price),1)])])])]),_:2},1032,["to"])]))),128))])):(l(),n("div",qt,[(l(!0),n(f,null,g(a.sortProducts,s=>(l(),n("div",{class:"col mt-4",key:s.id},[h(v,{class:"text-decoration-none",to:`/product/${s.id}`},{default:p(()=>[t("div",It,[t("div",Rt,[t("div",null,[t("span",St,[Tt,d(" "+i(s.nation)+i(s.area),1)]),t("img",{src:s.imagesUrl[0],style:{height:"240px","z-index":"1"},class:"card-img-top object-fit-cover",alt:"product-img"},null,8,Vt)])]),t("div",Et,[t("span",jt,[Ot,d(" "+i(s.category),1)]),t("h4",Ut,i(s.title),1),t("p",null,i(s.feature),1),t("p",Nt,[t("del",zt," NT$"+i(s.origin_price),1),Mt,d(" NT$"+i(s.price),1)])])])]),_:2},1032,["to"])]))),128))]))]),t("div",Dt,[this.filterArea.length===0&&this.category===""?(l(),C(F,{key:0,pagination:r.pagination,onEmitGetlist:a.getProductsList},null,8,["pagination","onEmitGetlist"])):P("",!0)])])])])],64)}const Qt=R(O,[["render",$t]]);export{Qt as default};
