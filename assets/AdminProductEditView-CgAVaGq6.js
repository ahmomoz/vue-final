import{L as f}from"./index-RIvZXr4n.js";import{d as v}from"./vuedraggable.umd-3TuldhJb.js";import{_ as y,c as u,a as t,t as x,m as U,i as p,b as w,w as k,j as i,v as d,s as V,r as h,o as c}from"./index-CEKiAcMy.js";const C={data(){return{drag:!1,product:{},isLoading:!0}},methods:{getProductData(){this.isLoading=!0;const{id:l}=this.$route.params;this.$axios.get("https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/products/all").then(o=>{const n=o.data.products;this.product=n[l]}).catch(o=>{this.$Swal.fire({icon:"error",title:o.response.data.message})}).finally(()=>{this.isLoading=!1})},updateProduct(){const l=this.product;this.$axios.put(`https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/product/${this.product.id}`,{data:l}).then(o=>{this.$Swal.fire({position:"top-end",icon:"success",title:"更新成功",showConfirmButton:!1,timer:700}),this.$router.push("/admin/products")}).catch(o=>{this.$Swal.fire({icon:"error",title:o.response.data.message})})},deleteAllImg(l){this.product.imagesUrl=[""]},deleteImg(l){this.product.imagesUrl.splice(l,1)},imgUrlUpdate(l){this.product.imagesUrl[0]===""?this.product.imagesUrl[0]=l:this.product.imagesUrl.push(l)},imgUpload(l){const o=l.target.files[0],n=new FormData;n.append("file-to-upload",o),this.$axios.post("https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/upload",n).then(a=>{const s=a.data.imageUrl;this.imgUrlUpdate(s)}).catch(a=>{this.$Swal.fire({icon:"error",title:a.response.data.message})})},changeCursor(l){const o=document.querySelector(".row.align-items-center");o&&(o.style.cursor=l?"move":"auto")},goBack(){this.$router.go(-1)}},created(){this.getProductData()},components:{Loading:f,draggable:v}},B={class:"container"},L={class:"fs-3 mt-3"},S={class:"mx-auto"},D={class:"card mt-4 shadow-sm"},M=t("div",{class:"card-header"},[t("h5",{class:"my-1"},"圖片資訊")],-1),P={class:"card-body"},A={class:"mb-3"},I=t("p",null,"上傳圖片",-1),z={class:"border-dashed-blue mb-3"},E=t("p",{class:"m-0 text-primary px-2"},"*第一張圖為商品主圖",-1),N={key:0,class:"py-5 bg-light"},j=t("p",{class:"px-2"},"請上傳圖片",-1),q=[j],F={class:"mb-3",style:{"max-width":"160px"}},K=["onClick"],T={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-dash-circle-fill",viewBox:"0 0 16 16",style:{color:"rgb(180, 81, 81)"}},G=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1z"},null,-1),H=[G],J=["src"],O={class:"card mt-4 shadow-sm"},Q=t("div",{class:"card-header"},[t("h5",{class:"my-1"},"基本資訊")],-1),R={class:"card-body"},W={class:"mb-3"},X=t("label",{for:"title",class:"form-label"},"*標題",-1),Y={class:"mb-3"},Z=t("label",{for:"feature",class:"form-label"},"*特色標語",-1),$={class:"row"},tt={class:"mb-3 col-md-6"},ot=t("label",{for:"nation",class:"form-label"},"*地區",-1),et={class:"mb-3 col-md-6"},st=t("label",{for:"area",class:"form-label"},"*縣市",-1),lt={class:"row"},it={class:"mb-3 col-md-6"},rt=t("label",{for:"category",class:"form-label"},"*分類",-1),dt={class:"mb-3 col-md-6"},nt=t("label",{for:"price",class:"form-label"},"*單位",-1),ct={class:"row"},at={class:"mb-3 col-md-6"},ut=t("label",{for:"origin_price",class:"form-label"},"*原價",-1),pt={class:"mb-3 col-md-6"},mt=t("label",{for:"price",class:"form-label"},"*售價",-1),ht=t("hr",null,null,-1),_t={class:"mb-3"},bt=t("label",{for:"description",class:"form-label"},"*產品描述",-1),gt={class:"mb-3"},ft=t("label",{for:"content",class:"form-label"},"*說明內容",-1),vt={class:"mb-3"},yt={class:"form-check"},xt=t("label",{class:"form-check-label",for:"is_enabled"},"是否上架",-1),Ut={class:"text-end mt-3 mb-5"};function wt(l,o,n,a,s,r){const _=h("loading"),b=h("draggable");return c(),u("div",B,[t("h1",L,"編輯產品 - "+x(s.product.title),1),t("div",S,[t("div",D,[M,t("div",P,[s.isLoading?(c(),U(_,{key:0,active:s.isLoading,"can-cancel":!1},null,8,["active"])):p("",!0),t("div",A,[I,t("input",{type:"file",id:"file",placeholder:"請輸入圖片連結",onChange:o[0]||(o[0]=e=>r.imgUpload(e))},null,32)]),t("div",z,[E,s.product.imagesUrl[0]?p("",!0):(c(),u("div",N,q)),w(b,{class:"row px-2",modelValue:s.product.imagesUrl,"onUpdate:modelValue":o[3]||(o[3]=e=>s.product.imagesUrl=e),group:"images",itemKey:"index",onStart:o[4]||(o[4]=e=>s.drag=!0),onEnd:o[5]||(o[5]=e=>s.drag=!1)},{item:k(({element:e,index:g})=>[t("div",F,[s.product.imagesUrl[0]?(c(),u("div",{key:0,class:"text-end",onClick:m=>r.deleteImg(g)},[(c(),u("svg",T,H))],8,K)):p("",!0),t("img",{class:"img-fluid",src:e,alt:"商品圖片",style:{height:"100px"},onMouseover:o[1]||(o[1]=m=>r.changeCursor(!0)),onMouseleave:o[2]||(o[2]=m=>r.changeCursor(!1))},null,40,J)])]),_:1},8,["modelValue"])]),t("button",{class:"btn btn-outline-primary btn-sm d-block w-100 mb-2",onClick:o[6]||(o[6]=(...e)=>r.deleteAllImg&&r.deleteAllImg(...e))}," 刪除所有圖片 ")])]),t("div",O,[Q,t("div",R,[t("div",W,[X,i(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":o[7]||(o[7]=e=>s.product.title=e)},null,512),[[d,s.product.title]])]),t("div",Y,[Z,i(t("input",{id:"feature",type:"text",class:"form-control",placeholder:"請輸入特色標語","onUpdate:modelValue":o[8]||(o[8]=e=>s.product.feature=e)},null,512),[[d,s.product.feature]])]),t("div",$,[t("div",tt,[ot,i(t("input",{id:"nation",type:"text",class:"form-control",placeholder:"請輸入地區","onUpdate:modelValue":o[9]||(o[9]=e=>s.product.nation=e)},null,512),[[d,s.product.nation]])]),t("div",et,[st,i(t("input",{id:"area",type:"text",class:"form-control",placeholder:"請輸入縣市","onUpdate:modelValue":o[10]||(o[10]=e=>s.product.area=e)},null,512),[[d,s.product.area]])])]),t("div",lt,[t("div",it,[rt,i(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":o[11]||(o[11]=e=>s.product.category=e)},null,512),[[d,s.product.category]])]),t("div",dt,[nt,i(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":o[12]||(o[12]=e=>s.product.unit=e)},null,512),[[d,s.product.unit]])])]),t("div",ct,[t("div",at,[ut,i(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":o[13]||(o[13]=e=>s.product.origin_price=e)},null,512),[[d,s.product.origin_price,void 0,{number:!0}]])]),t("div",pt,[mt,i(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":o[14]||(o[14]=e=>s.product.price=e)},null,512),[[d,s.product.price,void 0,{number:!0}]])])]),ht,t("div",_t,[bt,i(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述",rows:"16","onUpdate:modelValue":o[15]||(o[15]=e=>s.product.description=e)},`
              `,512),[[d,s.product.description]])]),t("div",gt,[ft,i(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":o[16]||(o[16]=e=>s.product.content=e)},`
              `,512),[[d,s.product.content]])]),t("div",vt,[t("div",yt,[i(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":o[17]||(o[17]=e=>s.product.is_enabled=e)},null,512),[[V,s.product.is_enabled]]),xt])])])])]),t("div",Ut,[t("button",{type:"button",class:"btn btn-outline-secondary mx-2",onClick:o[18]||(o[18]=(...e)=>r.goBack&&r.goBack(...e))}," 取消 "),t("button",{type:"button",class:"btn btn-primary",onClick:o[19]||(o[19]=(...e)=>r.updateProduct&&r.updateProduct(...e))}," 確認 ")])])}const Bt=y(C,[["render",wt]]);export{Bt as default};
