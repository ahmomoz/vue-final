import{L as y}from"./index-jRP1il9b.js";import{d as x}from"./vuedraggable.umd-3gXWdNp0.js";import{_ as U,r as b,o as a,c as u,b as e,t as V,g as k,h as p,d as w,w as C,k as r,v as d,q as E}from"./index-wczSaofn.js";var I={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"ahmomoz",BASE_URL:"/vue-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:m,VITE_APIPATH:_}=I,P={data(){return{drag:!1,product:{},isLoading:!0}},methods:{getProductData(){this.isLoading=!0;const{id:l}=this.$route.params;this.$axios.get(`${m}/api/${_}/admin/products/all`).then(o=>{const n=o.data.products;this.product=n[l]}).catch(o=>{this.$Swal.fire({icon:"error",title:o.response.data.message})}).finally(()=>{this.isLoading=!1})},updateProduct(){const l=this.product;this.$axios.put(`${m}/api/${_}/admin/product/${this.product.id}`,{data:l}).then(o=>{this.$Swal.fire({position:"top-end",icon:"success",title:"更新成功",showConfirmButton:!1,timer:700}),this.$router.push("/dashboard/products")}).catch(o=>{this.$Swal.fire({icon:"error",title:o.response.data.message})})},deleteAllImg(l){this.product.imagesUrl=[""]},deleteImg(l){this.product.imagesUrl.splice(l,1)},imgUrlUpdate(l){this.product.imagesUrl[0]===""?this.product.imagesUrl[0]=l:this.product.imagesUrl.push(l)},imgUpload(l){const o=l.target.files[0],n=new FormData;n.append("file-to-upload",o),this.$axios.post(`${m}/api/${_}/admin/upload`,n).then(c=>{const s=c.data.imageUrl;this.imgUrlUpdate(s)}).catch(c=>{this.$Swal.fire({icon:"error",title:c.response.data.message})})},changeCursor(l){const o=document.querySelector(".row.align-items-center");o&&(o.style.cursor=l?"move":"auto")},goBack(){this.$router.go(-1)}},created(){this.getProductData()},components:{Loading:y,draggable:x}},A={class:"container"},L={class:"fs-3 mt-3"},S={class:"mx-auto"},B={class:"card mt-4 shadow-sm"},D=e("div",{class:"card-header"},[e("h5",{class:"my-1"},"圖片資訊")],-1),T={class:"card-body"},M={class:"mb-3"},R=e("p",null,"上傳圖片",-1),N={class:"border-dashed-blue mb-3"},q=e("p",{class:"m-0 text-primary px-2"},"*第一張圖為商品主圖",-1),H={key:0,class:"py-5 bg-light"},O=e("p",{class:"px-2"},"請上傳圖片",-1),j=[O],z={class:"mb-3",style:{"max-width":"160px"}},F=["onClick"],K=e("span",{class:"bi bi-dash-circle-fill",style:{color:"rgb(180, 81, 81)"}},null,-1),G=[K],J=["src"],Q={class:"card mt-4 shadow-sm"},W=e("div",{class:"card-header"},[e("h5",{class:"my-1"},"基本資訊")],-1),X={class:"card-body"},Y={class:"mb-3"},Z=e("label",{for:"title",class:"form-label"},"*標題",-1),$={class:"mb-3"},ee=e("label",{for:"feature",class:"form-label"},"*特色標語",-1),oe={class:"row"},te={class:"mb-3 col-md-6"},se=e("label",{for:"nation",class:"form-label"},"*地區",-1),le={class:"mb-3 col-md-6"},re=e("label",{for:"area",class:"form-label"},"*縣市",-1),de={class:"row"},ie={class:"mb-3 col-md-6"},ne=e("label",{for:"address",class:"form-label"},"*地址",-1),ce={class:"mb-3 col-md-6"},ae=e("label",{for:"addressEmbedCode",class:"form-label"},"*地址嵌入碼",-1),ue={class:"row"},pe={class:"mb-3 col-md-6"},me=e("label",{for:"category",class:"form-label"},"*分類",-1),_e={class:"mb-3 col-md-6"},he=e("label",{for:"price",class:"form-label"},"*單位",-1),be={class:"row"},fe={class:"mb-3 col-md-6"},ge=e("label",{for:"origin_price",class:"form-label"},"*原價",-1),ve={class:"mb-3 col-md-6"},ye=e("label",{for:"price",class:"form-label"},"*售價",-1),xe=e("hr",null,null,-1),Ue={class:"mb-3"},Ve=e("label",{for:"description",class:"form-label"},"*產品描述",-1),ke={class:"mb-3"},we=e("label",{for:"content",class:"form-label"},"*說明內容",-1),Ce={class:"mb-3"},Ee={class:"form-check"},Ie=e("label",{class:"form-check-label",for:"is_enabled"},"是否上架",-1),Pe={class:"text-end mt-3 mb-5"};function Ae(l,o,n,c,s,i){const f=b("loading"),g=b("draggable");return a(),u("div",A,[e("h1",L,"編輯產品 - "+V(s.product.title),1),e("div",S,[e("div",B,[D,e("div",T,[s.isLoading?(a(),k(f,{key:0,active:s.isLoading,"can-cancel":!1},null,8,["active"])):p("",!0),e("div",M,[R,e("input",{type:"file",id:"file",placeholder:"請輸入圖片連結",onChange:o[0]||(o[0]=t=>i.imgUpload(t))},null,32)]),e("div",N,[q,s.product.imagesUrl[0]?p("",!0):(a(),u("div",H,j)),w(g,{class:"row px-2",modelValue:s.product.imagesUrl,"onUpdate:modelValue":o[3]||(o[3]=t=>s.product.imagesUrl=t),group:"images",itemKey:"index",onStart:o[4]||(o[4]=t=>s.drag=!0),onEnd:o[5]||(o[5]=t=>s.drag=!1)},{item:C(({element:t,index:v})=>[e("div",z,[s.product.imagesUrl[0]?(a(),u("div",{key:0,class:"text-end",onClick:h=>i.deleteImg(v)},G,8,F)):p("",!0),e("img",{class:"object-fit-cover",src:t,alt:"商品圖片",style:{height:"100px"},onMouseover:o[1]||(o[1]=h=>i.changeCursor(!0)),onMouseleave:o[2]||(o[2]=h=>i.changeCursor(!1))},null,40,J)])]),_:1},8,["modelValue"])]),e("button",{class:"btn btn-outline-primary btn-sm d-block w-100 mb-2",onClick:o[6]||(o[6]=(...t)=>i.deleteAllImg&&i.deleteAllImg(...t))}," 刪除所有圖片 ")])]),e("div",Q,[W,e("div",X,[e("div",Y,[Z,r(e("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":o[7]||(o[7]=t=>s.product.title=t)},null,512),[[d,s.product.title]])]),e("div",$,[ee,r(e("input",{id:"feature",type:"text",class:"form-control",placeholder:"請輸入特色標語","onUpdate:modelValue":o[8]||(o[8]=t=>s.product.feature=t)},null,512),[[d,s.product.feature]])]),e("div",oe,[e("div",te,[se,r(e("input",{id:"nation",type:"text",class:"form-control",placeholder:"請輸入地區","onUpdate:modelValue":o[9]||(o[9]=t=>s.product.nation=t)},null,512),[[d,s.product.nation]])]),e("div",le,[re,r(e("input",{id:"area",type:"text",class:"form-control",placeholder:"請輸入縣市","onUpdate:modelValue":o[10]||(o[10]=t=>s.product.area=t)},null,512),[[d,s.product.area]])])]),e("div",de,[e("div",ie,[ne,r(e("input",{id:"address",type:"text",class:"form-control",placeholder:"請輸入商品所在地址","onUpdate:modelValue":o[11]||(o[11]=t=>s.product.address=t)},null,512),[[d,s.product.address]])]),e("div",ce,[ae,r(e("input",{id:"addressEmbedCode",type:"text",class:"form-control",placeholder:"請輸入嵌入碼","onUpdate:modelValue":o[12]||(o[12]=t=>s.product.addressEmbedCode=t)},null,512),[[d,s.product.addressEmbedCode]])])]),e("div",ue,[e("div",pe,[me,r(e("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":o[13]||(o[13]=t=>s.product.category=t)},null,512),[[d,s.product.category]])]),e("div",_e,[he,r(e("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":o[14]||(o[14]=t=>s.product.unit=t)},null,512),[[d,s.product.unit]])])]),e("div",be,[e("div",fe,[ge,r(e("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":o[15]||(o[15]=t=>s.product.origin_price=t)},null,512),[[d,s.product.origin_price,void 0,{number:!0}]])]),e("div",ve,[ye,r(e("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":o[16]||(o[16]=t=>s.product.price=t)},null,512),[[d,s.product.price,void 0,{number:!0}]])])]),xe,e("div",Ue,[Ve,r(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述",rows:"16","onUpdate:modelValue":o[17]||(o[17]=t=>s.product.description=t)},`
              `,512),[[d,s.product.description]])]),e("div",ke,[we,r(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":o[18]||(o[18]=t=>s.product.content=t)},`
              `,512),[[d,s.product.content]])]),e("div",Ce,[e("div",Ee,[r(e("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":o[19]||(o[19]=t=>s.product.is_enabled=t)},null,512),[[E,s.product.is_enabled]]),Ie])])])])]),e("div",Pe,[e("button",{type:"button",class:"btn btn-outline-secondary mx-2",onClick:o[20]||(o[20]=(...t)=>i.goBack&&i.goBack(...t))}," 取消 "),e("button",{type:"button",class:"btn btn-primary text-light",onClick:o[21]||(o[21]=(...t)=>i.updateProduct&&i.updateProduct(...t))}," 確認 ")])])}const De=U(P,[["render",Ae]]);export{De as default};
