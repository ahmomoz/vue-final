import{L as u}from"./index-T4iu_HKs.js";import{h as f}from"./moment-WSJ9un1t.js";import{_ as p,r as g,o as i,c as d,a as s,u as r,s as b,t as y,F as x,q as w}from"./index-AmqyvTUw.js";var v={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"ahmomoz",BASE_URL:"/vue-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:l,VITE_APIPATH:_}=v,k={props:["id"],data(){return{order:{},isLoading:!0,currentPage:""}},methods:{getOrderList(n){this.isLoading=!0;const{id:e}=this.$route.params;this.$axios.get(`${l}/api/${_}/admin/orders?page=${n}`).then(c=>{const m=c.data.orders;this.order=m.find(t=>t.id.toLowerCase().includes(e.toLowerCase()))}).catch(c=>{this.$Swal.fire({icon:"error",title:c.response.data.message})}).finally(()=>{this.isLoading=!1})},goBack(){this.$router.push("/dashboard/orders")},togglePaymentStatus(){this.isLoading=!0,this.order.is_paid=!this.order.is_paid;const{id:n}=this.$route.params;this.$axios.put(`${l}/api/${_}/admin/order/${n}`,{data:this.order}).then(e=>{this.$Swal.fire({position:"top-end",icon:"success",title:"更新成功",showConfirmButton:!1,timer:700}),this.getOrderList(this.currentPage)}).catch(e=>{this.$Swal.fire({icon:"error",title:e.response.data.message})}).finally(()=>{this.isLoading=!1})},deleteOrder(){this.$Swal.fire({title:"即將刪除商品",text:`確定要刪除「${this.order.create_at}」嗎？`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#eb5a68",cancelButtonColor:"#8bafd7",confirmButtonText:"確定刪除",cancelButtonText:"取消"}).then(n=>{n.isConfirmed&&this.$axios.delete(`${l}/api/${_}/admin/order/${this.order.id}`).then(e=>{this.$Swal.fire({position:"top-end",icon:"success",title:"已刪除",showConfirmButton:!1,timer:700}),this.$router.push("/dashboard/orders")}).catch(e=>{this.$Swal.fire({icon:"error",title:e.response.data.message})})})},formatDateString(n){return f(n).format("YYYY-MM-DD HH:mm:ss")}},created(){this.isLoading=!1,this.currentPage=this.$route.query.currentPage,this.getOrderList(this.currentPage)},components:{Loading:u}},L={class:"container"},P={class:"d-flex justify-content-between my-3"},S=s("h1",{class:"fs-3"},"訂單詳情",-1),B={class:"row rounded border-2 border-dashed-blue p-2"},C=s("dt",{class:"col-sm-3 text-truncate text-primary"},"訂單編號",-1),T={class:"col-sm-9 text-primary"},E=s("dt",{class:"col-sm-3 text-truncate text-primary"},"訂單金額",-1),O={class:"col-sm-9 text-primary"},A=s("dt",{class:"col-sm-3 text-truncate text-primary"},"訂單狀態",-1),D={key:0,class:"col-sm-9 text-primary"},I={key:1,class:"col-sm-9 text-primary"},V=s("dt",{class:"col-sm-3 text-truncate text-primary"},"發票狀態",-1),$=s("dd",{class:"col-sm-9 text-primary"},"未開立",-1),N={class:"row card mt-4 shadow-sm"},R=s("div",{class:"card-header"},[s("h5",{class:"my-1"},"購買商品")],-1),H={class:"card-body"},U=["src"],Y={class:"mx-2 my-auto"},q={class:"text-end mx-2 my-auto"},M={class:"card-footer"},F={class:"text-end fs-5 m-0"},j={class:"row card mt-4 shadow-sm"},z=s("div",{class:"card-header"},[s("h5",{class:"my-1"},"收件人資訊")],-1),G={class:"card-body"},J={class:"mb-3"},K=s("label",{for:"name",class:"form-label fw-bold"},"姓名",-1),Q={class:"fs-5"},W={class:"mb-3"},X=s("label",{for:"tel",class:"form-label fw-bold"},"電話",-1),Z={class:"fs-5"},ss={class:"mb-3"},ts=s("label",{for:"address",class:"form-label fw-bold"},"地址",-1),es={class:"fs-5"},os={class:"mb-3"},rs=s("label",{for:"email",class:"form-label fw-bold"},"E-mail",-1),is={class:"fs-5"},as={class:"mb-3"},ds=s("label",{for:"message",class:"form-label fw-bold"},"備註",-1),ns={key:0,class:"fs-5"},cs={key:1,class:"fs-5"},ls={class:"mb-3"},_s=s("label",{for:"message",class:"form-label fw-bold"},"訂單成立時間",-1),ms={class:"fs-5"},hs={class:"text-end mt-3 mb-5"};function us(n,e,c,m,t,a){const h=g("loading");return i(),d("div",L,[s("div",P,[S,t.order.is_paid?(i(),d("button",{key:0,type:"button",class:"btn btn-primary text-light",onClick:e[0]||(e[0]=(...o)=>a.togglePaymentStatus&&a.togglePaymentStatus(...o))}," 切換成未付款 ")):(i(),d("button",{key:1,type:"button",class:"btn btn-primary text-light",onClick:e[1]||(e[1]=(...o)=>a.togglePaymentStatus&&a.togglePaymentStatus(...o))}," 切換成已付款 "))]),s("dl",B,[C,s("dd",T,r(t.order.create_at),1),E,s("dd",O,"NT $"+r(t.order.total),1),A,t.order.is_paid?(i(),d("dd",D,"訂單已付款完成")):(i(),d("dd",I,"訂單尚未付款")),V,$]),s("div",N,[R,s("div",H,[t.isLoading?(i(),b(h,{key:0,active:t.isLoading,"can-cancel":!1},null,8,["active"])):y("",!0),(i(!0),d(x,null,w(t.order.products,o=>(i(),d("div",{key:o.product.id,class:"d-flex align-items-center m-2"},[s("img",{src:o.product.imagesUrl[0],alt:"商品圖片",style:{width:"100px"}},null,8,U),s("p",Y,r(o.product.title)+" x "+r(o.qty),1),s("p",q," NT$ "+r(o.product.price),1)]))),128))]),s("div",M,[s("p",F,"總金額 NT$ "+r(t.order.total),1)])]),s("div",j,[z,s("div",G,[s("div",J,[K,s("p",Q,r(t.order.user.name),1)]),s("div",W,[X,s("p",Z,r(t.order.user.tel),1)]),s("div",ss,[ts,s("p",es,r(t.order.user.address),1)]),s("div",os,[rs,s("p",is,r(t.order.user.email),1)]),s("div",as,[ds,t.order.user.message?(i(),d("p",ns,r(t.order.user.message),1)):(i(),d("p",cs,"無填寫備註"))]),s("div",ls,[_s,s("p",ms,r(a.formatDateString(t.order.user.date)),1)])])]),s("div",hs,[s("button",{type:"button",class:"btn btn-outline-secondary mx-2",onClick:e[2]||(e[2]=(...o)=>a.goBack&&a.goBack(...o))}," 返回前頁 "),s("button",{type:"button",class:"btn btn-danger text-light",onClick:e[3]||(e[3]=(...o)=>a.deleteOrder&&a.deleteOrder(...o))}," 刪除訂單 ")])])}const bs=p(k,[["render",us]]);export{bs as default};
