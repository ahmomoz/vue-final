import{C as P}from"./CardPagination-gCeWb9Lk.js";import{L as w}from"./index-2DP29vLu.js";import{_ as k,r as p,o as n,c as i,a as t,j as x,v as C,t as l,b as _,w as m,d,m as B,i as L,F as g,h as b}from"./index-qs2BhPg8.js";var T={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"ahmomoz",BASE_URL:"/vue-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:I,VITE_APIPATH:S}=T,V={data(){return{sortBy:"default",ascending:!0,allProducts:[],products:[],searchInput:"",pagination:{},isLoading:!0}},methods:{getProductsList(r=1){this.isLoading=!0,this.$axios.get(`${I}/api/${S}/admin/products?page=${r}`).then(e=>{const{products:a,pagination:u}=e.data;this.allProducts=a,this.products=a,this.pagination=u}).catch(e=>{alert(e.response.data.message)}).finally(()=>{this.isLoading=!1})},deleteProduct(r,e){this.$Swal.fire({title:"即將刪除商品",text:`確定要刪除「${r}」嗎？`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#eb5a68",cancelButtonColor:"#8bafd7",confirmButtonText:"確定刪除",cancelButtonText:"取消"}).then(a=>{a.isConfirmed&&this.$axios.delete(`https://vue3-course-api.hexschool.io/v2/api/ahmomoz/admin/product/${e}`).then(u=>{this.$Swal.fire({position:"top-end",title:"已刪除",icon:"success",showConfirmButton:!1,timer:700}),this.getProductsList()}).catch(u=>{this.$Swal.fire({icon:"error",title:u.response.data.message})})})},productSearch(){this.products=this.productsFilteredResults}},computed:{sortProducts(){return[...this.products].sort((e,a)=>this.ascending?e[this.sortBy]-a[this.sortBy]:a[this.sortBy]-e[this.sortBy])},productsFilteredResults(){return this.allProducts.filter(e=>e.title.toLowerCase().includes(this.searchInput.toLowerCase()))}},mounted(){this.getProductsList()},components:{CardPagination:P,Loading:w}},E={class:"card mt-lg-3 shadow-sm"},A={class:"navbar navbar-light bg-light"},N={class:"container-fluid"},R={class:"row g-2 align-items-center"},$={class:"col-auto"},D={class:"col-auto"},F={class:"card my-1 my-lg-4 shadow-sm"},U={class:"card-header"},j={class:"text-end py-2"},z=t("span",{class:"bi bi-plus"},null,-1),G={class:"card-body"},H={class:"table table-hover"},M={class:"bg-light"},O={class:"align-middle"},q=t("th",null,"分類",-1),J=t("th",null,"地區",-1),K=t("th",null,"產品名稱",-1),Q=t("span",{class:"bi bi-arrow-down-up ms-1"},null,-1),W=t("th",null,"狀態",-1),X=t("th",null,"操作",-1),Y={key:0},Z=t("br",null,null,-1),tt={style:{color:"rgb(196, 196, 196)"}},st={key:0,class:"text-primary"},et={key:1},nt={class:"btn-group"},ot=["onClick"],it={key:1},lt=t("br",null,null,-1),at={style:{color:"rgb(196, 196, 196)"}},rt={key:0,class:"text-success"},ct={key:1},dt={class:"btn-group"},ut=["onClick"],_t={class:"card-footer d-flex justify-content-center"};function ht(r,e,a,u,o,c){const h=p("router-link"),y=p("loading"),f=p("card-pagination");return n(),i(g,null,[t("div",E,[t("nav",A,[t("div",N,[t("form",R,[t("div",$,[x(t("input",{class:"form-control",type:"search",placeholder:"搜尋商品名稱","aria-label":"Search","onUpdate:modelValue":e[0]||(e[0]=s=>o.searchInput=s)},null,512),[[C,o.searchInput]])]),t("div",D,[t("button",{class:"btn btn-outline-primary",type:"submit",onClick:e[1]||(e[1]=(...s)=>c.productSearch&&c.productSearch(...s))},"搜尋")])])])])]),t("div",F,[t("div",U,[t("div",j,[t("button",{type:"button",class:"btn btn-primary text-white mx-3",onClick:e[2]||(e[2]=s=>o.ascending=!o.ascending)},l(o.ascending?"降冪":"升冪")+"排序 ",1),_(h,{class:"btn btn-primary text-light",to:"product/add"},{default:m(()=>[z,d(" 建立新的產品 ")]),_:1})])]),t("div",G,[t("table",H,[t("thead",M,[t("tr",O,[q,J,K,t("th",{onClick:e[3]||(e[3]=s=>o.sortBy="price")},[d(" 售價 "),Q]),W,X])]),o.sortBy==="default"?(n(),i("tbody",Y,[o.isLoading?(n(),B(y,{key:0,active:o.isLoading,"can-cancel":!1},null,8,["active"])):L("",!0),(n(!0),i(g,null,b(o.products,s=>(n(),i("tr",{key:s.id},[t("td",null,l(s.category),1),t("td",null,l(s.nation),1),t("td",null,l(s.title),1),t("td",null,[d(" NT$"+l(s.price)+" ",1),Z,t("del",tt," NT$"+l(s.origin_price),1)]),t("td",null,[s.is_enabled?(n(),i("span",st,"上架中")):(n(),i("span",et,"未上架"))]),t("td",null,[t("div",nt,[_(h,{class:"btn btn-outline-primary btn-sm",to:"product/edit/"+s.id},{default:m(()=>[d("編輯")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:v=>c.deleteProduct(s.title,s.id)}," 刪除 ",8,ot)])])]))),128))])):(n(),i("tbody",it,[(n(!0),i(g,null,b(c.sortProducts,s=>(n(),i("tr",{key:s.name},[t("td",null,l(s.category),1),t("td",null,l(s.nation),1),t("td",null,l(s.title),1),t("td",null,[d(" NT$"+l(s.price)+" ",1),lt,t("del",at," NT$"+l(s.origin_price),1)]),t("td",null,[s.is_enabled?(n(),i("span",rt,"上架中")):(n(),i("span",ct,"未上架"))]),t("td",null,[t("div",dt,[_(h,{class:"btn btn-outline-primary btn-sm",to:"product/edit/"+s.id},{default:m(()=>[d("編輯")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:v=>c.deleteProduct(s.title,s.id)}," 刪除 ",8,ut)])])]))),128))]))])]),t("div",_t,[_(f,{pagination:o.pagination,onEmitGetlist:c.getProductsList},null,8,["pagination","onEmitGetlist"])])])],64)}const bt=k(V,[["render",ht]]);export{bt as default};
