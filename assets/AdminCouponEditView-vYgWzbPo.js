import{L as f}from"./index-wfxNMEda.js";import{C as b}from"./main-n3PbHA-s.js";import{_ as g,r as d,o as u,c as v,b as o,g as V,h as k,k as a,v as c,d as L,q as x}from"./index-VULnoIJU.js";var C={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"ahmomoz",BASE_URL:"/vue-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:p,VITE_APIPATH:m}=C,y={props:["id"],data(){return{drag:!1,coupon:{},currentPage:"",isLoading:!0,currentDate:new Date}},methods:{getCouponList(r){this.isLoading=!0;const{id:e}=this.$route.params;this.$axios.get(`${p}/api/${m}/admin/coupons?page=${r}`).then(n=>{const i=n.data.coupons;this.coupon=i.find(t=>t.id.toLowerCase().includes(e.toLowerCase()))}).catch(n=>{this.$Swal.fire({icon:"error",title:n.response.data.message})}).finally(()=>{this.isLoading=!1})},addCoupon(){const e=Math.floor(new Date().getTime()/1e3);this.coupon.add_date=e,this.coupon.due_date=Math.floor(this.currentDate.getTime()/1e3);const n=this.coupon;this.isLoading=!0,this.$axios.put(`${p}/api/${m}/admin/coupon/${this.coupon.id}`,{data:n}).then(i=>{this.isLoading=!1,this.$Swal.fire({position:"top-end",icon:"success",title:"更新成功",showConfirmButton:!1,timer:700}),this.$router.push("/dashboard/coupons")}).catch(i=>{this.isLoading=!1,this.$Swal.fire({icon:"error",title:i.response.data.message})})},goBack(){this.$router.go(-1)}},mounted(){this.isLoading=!1,this.getCouponList(this.$route.query.currentPage)},components:{Loading:f,VueDatePicker:b}},P={class:"container"},w=o("h1",{class:"fs-3 mt-3"},"新增優惠券",-1),D={class:"mx-auto"},T={class:"card mt-4 shadow-sm"},A=o("div",{class:"card-header"},[o("h5",{class:"my-1"},"基本資訊")],-1),B={class:"card-body"},E={class:"row"},I={class:"mb-3"},U=o("label",{for:"title",class:"form-label"},"*優惠券名稱",-1),S={class:"mb-3 col-md-6"},M=o("label",{for:"due_date",class:"form-label"},"*到期時間",-1),R={class:"row"},H={class:"mb-3 col-md-6"},N=o("label",{for:"code",class:"form-label"},"*折扣碼",-1),q={class:"mb-3 col-md-6"},O=o("label",{for:"origin_price",class:"form-label"},"*折扣數",-1),z={class:"mb-3"},Y=o("label",{for:"content",class:"form-label"},"備註(選填)",-1),$={class:"mb-3"},j={class:"form-check"},F=o("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),G={class:"text-end mt-3 mb-5"};function J(r,e,n,i,t,l){const _=d("loading"),h=d("VueDatePicker");return u(),v("div",P,[w,o("div",D,[t.isLoading?(u(),V(_,{key:0,active:t.isLoading,"can-cancel":!1},null,8,["active"])):k("",!0),o("div",T,[A,o("div",B,[o("div",E,[o("div",I,[U,a(o("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入優惠券名稱","onUpdate:modelValue":e[0]||(e[0]=s=>t.coupon.title=s)},null,512),[[c,t.coupon.title]])]),o("div",S,[M,L(h,{modelValue:t.currentDate,"onUpdate:modelValue":e[1]||(e[1]=s=>t.currentDate=s)},null,8,["modelValue"])])]),o("div",R,[o("div",H,[N,a(o("input",{id:"code",type:"text",class:"form-control",placeholder:"請輸入折扣碼(例如:HAPPY800)","onUpdate:modelValue":e[2]||(e[2]=s=>t.coupon.code=s)},null,512),[[c,t.coupon.code]])]),o("div",q,[O,a(o("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入數字(例如:折20%請填80)","onUpdate:modelValue":e[3]||(e[3]=s=>t.coupon.percent=s)},null,512),[[c,t.coupon.percent,void 0,{number:!0}]])])]),o("div",z,[Y,a(o("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入備註","onUpdate:modelValue":e[4]||(e[4]=s=>t.coupon.content=s)},`
            `,512),[[c,t.coupon.content]])]),o("div",$,[o("div",j,[a(o("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[5]||(e[5]=s=>t.coupon.is_enabled=s)},null,512),[[x,t.coupon.is_enabled]]),F])])])])]),o("div",G,[o("button",{type:"button",class:"btn btn-outline-secondary mx-2",onClick:e[6]||(e[6]=(...s)=>l.goBack&&l.goBack(...s))}," 取消 "),o("button",{type:"button",class:"btn btn-primary text-light",onClick:e[7]||(e[7]=(...s)=>l.addCoupon&&l.addCoupon(...s))}," 更新 ")])])}const X=g(y,[["render",J]]);export{X as default};
